{% extends 'base.html' %}

{% block content %}
<div class="row">
    <div class="col-md-8">
        <h2 class="fw-bold mb-4">最新动态</h2>
        {% for post in posts %}
        <div class="card shadow-sm mb-4 border-0 hover-lift">
            <div class="card-body p-4">
                <h3 class="h4"><a href="{{ url_for('post', post_id=post['id']) }}" class="text-decoration-none text-dark fw-bold">{{ post['title'] }}</a></h3>
                <p class="text-muted small mb-2">{{ post['created_at'] }}</p>
                <p class="text-secondary">{{ post['content']|truncate(100) }}</p>
            </div>
        </div>
        {% endfor %}
    </div>

    <div class="col-md-4 ps-md-5">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h5 class="fw-bold m-0 text-secondary">创作轨迹</h5>
            <div class="btn-group btn-group-sm">
                <a href="/?mode=month" class="btn btn-outline-primary {% if mode=='month' %}active{% endif %}">月</a>
                <a href="/?mode=year" class="btn btn-outline-primary {% if mode=='year' %}active{% endif %}">年</a>
            </div>
        </div>

        <div class="timeline">
            {% for group in grouped_posts %}
            <div class="timeline-group mb-4">
                <div class="timeline-period-label">{{ group.period }}</div>
                
                {% for post in group.posts %}
                <div class="timeline-item">
                    <div class="timeline-marker"></div>
                    <div class="timeline-content">
                        <a href="{{ url_for('post', post_id=post['id']) }}" class="timeline-title">
                            {{ post['title'] }}
                        </a>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% endfor %}
        </div>
    </div>
</div>

<style>
    /* 时间线容器 */
    .timeline {
        position: relative;
        padding-left: 1rem;
        border-left: 2px solid #e9ecef;
        margin-left: 10px;
    }
    
    /* 时间周期标签（年/月） */
    .timeline-period-label {
        position: relative;
        left: -1.7rem;
        background: #f8f9fa;
        display: inline-block;
        padding: 2px 8px;
        font-weight: bold;
        color: #0d6efd;
        font-size: 0.9rem;
        margin-bottom: 10px;
        z-index: 1;
    }

    .timeline-item {
        position: relative;
        margin-bottom: 0.8rem;
        padding-left: 0.5rem;
    }

    .timeline-marker {
        position: absolute;
        left: calc(-1rem - 6px);
        width: 9px;
        height: 9px;
        border-radius: 50%;
        background-color: #dee2e6;
        border: 2px solid #fff;
        top: 6px;
        transition: 0.3s;
    }

    .timeline-item:hover .timeline-marker {
        background-color: #0d6efd;
        transform: scale(1.4);
    }

    .timeline-title {
        display: block;
        font-size: 0.85rem;
        color: #6c757d;
        text-decoration: none;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .timeline-title:hover { color: #0d6efd; }
</style>
{% endblock %}